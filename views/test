<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/public/styles/myAccount.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <title>Order Details</title>
  <style>
    .back-button {
      display: inline-block;
      margin: 15px 0;
      padding: 10px 15px;
      background-color: #ccc;
      border: none;
      cursor: pointer;
      text-decoration: none;
      color: black;
      border-radius: 5px;
    }

    .info-grid {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    .product-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    .product-item {
      border: 1px solid #ddd;
      padding: 15px;
      text-align: center;
    }

    .product-item img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      margin-bottom: 10px;
    }

    .status-bar {
      width: 100%;
      height: 20px;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
      margin: 20px 0;
    }

    .status-progress {
      height: 100%;
      width: 0;
    }

    /* Status Colors */
    .status-pending { background-color: gray; }
    .status-processing { background-color: blue; }
    .status-shipped { background-color: pink; }
    .status-delivered { background-color: green; }
    i {
  font-size: 24px; /* Change the size */
  color: pink; /* Change the color */
}
  </style>
</head>
<body>
    <!-- Topbar -->
    <div class="top-bar">
        <!-- Left elements -->
        <div class="left-section">
            <img src="/public/images/shooping_cart.svg" alt="Icon 1" class="icon">
            <img src="/public/images/logout.svg" alt="Icon 1" class="icon" onClick="window.location.href='/logout'">
        </div>
        <!-- Logo -->
        <div class="center-section">
            <img src="/public/images/logo.svg" class="logo"> 
        </div>
        <!-- Right elements -->
        <div class="right-section">
            <img src="/public/images/home_icon.svg" alt="Icon 1" class="icon" onclick="window.location.href='/products'">
            <% if (user.role === 'admin') { %> 
                <img src="/public/images/adminIcon.svg" alt="Icon 1" class="icon" onclick="window.location.href='/personal/admin'">
            <% } %>
        </div>
    </div>
    <!-- Back Button -->
    <!-- Account Section -->
    <div class="account-section">
        <div class="account-header">
            <h2>Hello <%= user.name %></h2>
        </div>
        <div class="account-content">
            <div class="account-menu">
                <button class="menu-option" onclick="window.location.href='/personal/myAccount/details'">Personal Details</button>
                <button class="menu-option" onclick="window.location.href='/personal/myAccount/favorite'">Favorites</button>
                <button class="menu-option active" onclick="window.location.href='/personal/myAccount/orders'">My Orders</button>
            </div>
            <div class="content">
            <!-- Account Details -->
                <div class="container">
                    <h1>Order Details for Order #<%= orderDetails.orderId %></h1>

                    <!-- Info Grid: Contact and Delivery Address -->
                    <div class="info-grid">
                        <!-- Contact Details -->
                        <section>
                            <h2><i class="fas fa-info-circle"></i> Contact Information</h2>
                            <p><strong>Name:</strong> <%= user.name %></p>
                            <p><strong>Email:</strong> <%= user.email %></p>
                            <p><strong>Phone:</strong> <%= orderDetails.phone %></p>
                        </section>

                        <!-- Delivery Address and Total Price -->
                        <section>
                            <h2><i class="fas fa-map-marker-alt"></i> Delivery Address</h2>
                            <p><%= orderDetails.address.street %> <%= orderDetails.address.number %>, <%= orderDetails.address.city %></p>
                            <h3>Total Price: $<%= orderDetails.totalPrice.toFixed(2) %></h3>
                        </section>
                    </div>

                    <!-- Product List in Grid -->
                    <section>
                        <h2><i class="fas fa-candy-cane"></i> Products in Order</h2>
                        <div class="product-grid">
                            <% orderDetails.products.forEach(product => { %>
                            <div class="product-item">
                                <img src="<%= product.image %>" alt="<%= product.name %>">
                                <h4><%= product.name %></h4>
                                <p>Quantity: <%= product.quantity %></p>
                                <p>Total: $<%= (product.price * product.quantity).toFixed(2) %></p>
                            </div>
                            <% }) %>
                        </div>
                    </section>

                    <!-- Order Status Bar -->
                    <section>
                        <h2><i class="fas fa-truck"></i> Order Status</h2>
                        <div class="status-bar">
                            <div class="status-progress" id="statusBar"></div>
                        </div>
                        <p id="statusText">Current status: <%= orderDetails.status %></p>
                    </section>
                    <a href="/personal/myAccount/orders" class="back-button">Back to My Orders</a>

                </div>
            </div>
        </div>
    </div>

    <script>
        // Dynamic status bar logic
        const statusBar = document.getElementById('statusBar');
        const statusText = document.getElementById('statusText');
        const status = "<%= orderDetails.status %>";

        let progress = 0;
        switch (status) {
            case "Pending":
                progress = 25;
                statusBar.classList.add('status-pending');
                statusText.innerText = "Pending";
                break;
            case "Processing":
                progress = 50;
                statusBar.classList.add('status-processing');
                statusText.innerText = "Processing";
                break;
            case "Shipped":
                progress = 75;
                statusBar.classList.add('status-shipped');
                statusText.innerText = "InDelivery";
                break;
            case "Delivered":
                progress = 100;
                statusBar.classList.add('status-delivered');
                statusText.innerText = "Delivered";
                break;
            default:
                progress = 0;
                statusText.innerText = "Unknown Status";
        }

        statusBar.style.width = progress + "%";
    </script>
</body>
</html>
